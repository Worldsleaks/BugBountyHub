# File upload vulnerabilities

File upload vulnerabilities are when a web server allows users to upload files to its filesystem without sufficiently validating things like their name, type, contents, or size. Failing to properly enforce restrictions on these could mean that even a basic image upload function can be used to upload arbitrary and potentially dangerous files instead. This could even include server-side script files that enable remote code execution.

## Useful File Extensions

* **PHP ->** _.php_, _.php2_, _.php3_, ._php4_, ._php5_, ._php6_, ._php7_, .phps, ._phps_, ._pht_, ._phtm, .phtml_, ._pgif_, _.shtml, .htaccess, .phar, .inc, .hphp, .ctp, .module_
* **ASP ->** _.asp, .aspx, .config, .ashx, .asmx, .aspq, .axd, .cshtm, .cshtml, .rem, .soap, .vbhtm, .vbhtml, .asa, .cer, .shtml_
* **Jsp ->** _.jsp, .jspx, .jsw, .jsv, .jspf, .wss, .do, .action_
* **Flash ->** _.swf_
* **Perl ->** _.pl, .cgi_

## Bypass File Extensions Checks

1. Test using **uppercase letters**: _pHp, pHP5..._
2. Add a **valid extension before** the wanted extension:
   * file.png.php
   * fiile.png.pHp
3. Add **special characters at the end.** Bruteforce all ASCII and Unicode characters.
   * _file.php%20_
   * _file.php%0a_
   * _file.php%00_
   * _file.php%0d%0a_
4. Try to bypass the protections **by** **adding junk** data (**null** bytes) between double extensions:
   * f_ile.php#.png_
   * f_ile.php%00.png_
   * _file.php\x00.png_
   * _file.php%0a.png_
   * _file.php%0d%0a.png_
   * _file.phpJunk123png_
5. Add **another layer of extensions:**
   * _file.png.jpg.php_
   * _file.php%00.png%00.jpg_
