# Passive Subdomain Enumeration

**Passive subdomain enumeration** is a technique used to discover subdomains without directly interacting with the targetâ€™s infrastructure. Instead, it relies on publicly available data sources such as search engines, public DNS records, certificate transparency logs, and third-party services like `VirusTotal`, `SecurityTrails`, or `Shodan`.

### Subdomains from Content Security Policy (CSP)

Content Security Policy (CSP) header allows administrators to specify which domains and subdomains are allowed to load content such as scripts, frame sources, image sources, etc.

<figure><img src="../../../.gitbook/assets/image.png" alt=""><figcaption><p>Domains &#x26; Subdomains from CSP Header</p></figcaption></figure>

The following `curl`command can be used to extract domains from the CSP header:

```bash
curl -I -s <URL> | grep -iE 'content-security-policy|CSP' \
  | tr " " "\n" | grep "\." | tr -d ";" \
  | sed 's/\*\.//g' | sort -u
```

### Subdomains using Favicon Hashes



```bash
curl -s "<URL>/favicon.ico" | base64 | python3 -c 'import mmh3, sys;print(mmh3.hash(sys.stdin.buffer.read()))' \
    | xargs -I{} shodan search http.favicon.hash:{} --fields hostnames \
    | tr ";" "\n"
```

