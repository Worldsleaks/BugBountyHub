# Passive Subdomain Enumeration

**Passive subdomain enumeration** is a technique used to discover subdomains without directly interacting with the targetâ€™s infrastructure. Instead, it relies on publicly available data sources such as search engines, public DNS records, certificate transparency logs, and third-party services like `VirusTotal`, `SecurityTrails`, or `Shodan`.

### Subdomains from Content Security Policy (CSP)

Content Security Policy (CSP) header allows administrators to specify which domains and subdomains are allowed to load content such as scripts, frame sources, image sources, etc.

<figure><img src="../../../.gitbook/assets/image (1) (1).png" alt=""><figcaption><p>Domains &#x26; Subdomains from CSP Header</p></figcaption></figure>

The following `curl`command can be used to extract domains from the CSP header:

```bash
curl -I -s <URL> | grep -iE 'content-security-policy|CSP' \
  | tr " " "\n" | grep "\." | tr -d ";" \
  | sed 's/\*\.//g' | sort -u
```

### Subdomains using Favicon Hashes

**Subdomain enumeration via favicon hashes** is a passive technique that identifies related domains by hashing a website's favicon (the small icon in the browser tab) and comparing it to hashes of other sites. Here's the process:

1. **Fetch the favicon** from `https://domain.com/favicon.ico` and hash it using **MurmurHash3**.
2. **Search for the hash** in platforms like **Shodan** or **Censys**, which index the internet's favicon hashes.
3. **Discover related subdomains**: Sites sharing the same favicon hash often belong to the same organization. This can reveal hidden subdomains.

Let's use it with Shodan:

```bash
curl -s "<URL>/favicon.ico" | base64 | python3 -c 'import mmh3, sys;print(mmh3.hash(sys.stdin.buffer.read()))' \
    | xargs -I{} shodan search http.favicon.hash:{} --fields hostnames \
    | tr ";" "\n"
```

